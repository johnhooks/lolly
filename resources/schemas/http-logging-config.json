{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "$id": "https://lolly.okaywp.com/schemas/http-logging-config.json",
    "title": "Lolly log configuration.",
    "description": "Configuration for the Lolly WordPress logging plugin.",
    "type": "object",
    "properties": {
        "version": {
            "description": "The config schema version number.",
            "type": "number"
        },
        "enabled": {
            "description": "Whether the Lolly logger is enabled.",
            "type": "boolean"
        },
        "wp_rest_logging": {
            "description": "WordPress REST API logging settings.",
            "type": "object",
            "properties": {
                "enabled": {
                    "description": "Whether REST API logging is enabled.",
                    "type": "boolean"
                }
            },
            "required": ["enabled"]
        },
        "wp_http_client_logging": {
            "description": "WordPress HTTP client logging settings.",
            "type": "object",
            "properties": {
                "enabled": {
                    "description": "Whether HTTP client logging is enabled.",
                    "type": "boolean"
                }
            },
            "required": ["enabled"]
        },
        "wp_user_event_logging": {
            "description": "User event logging settings.",
            "type": "object",
            "properties": {
                "enabled": {
                    "description": "Whether user event logging is enabled.",
                    "type": "boolean"
                }
            },
            "required": ["enabled"]
        },
        "wp_auth_logging": {
            "description": "Authentication event logging settings.",
            "type": "object",
            "properties": {
                "enabled": {
                    "description": "Whether authentication event logging is enabled.",
                    "type": "boolean"
                },
                "login": {
                    "description": "Log successful user logins.",
                    "type": "boolean"
                },
                "logout": {
                    "description": "Log user logouts.",
                    "type": "boolean"
                },
                "login_failed": {
                    "description": "Log failed login attempts.",
                    "type": "boolean"
                },
                "password_changed": {
                    "description": "Log password changes and resets.",
                    "type": "boolean"
                },
                "app_password_created": {
                    "description": "Log application password creation.",
                    "type": "boolean"
                },
                "app_password_deleted": {
                    "description": "Log application password deletion.",
                    "type": "boolean"
                }
            },
            "required": [
                "enabled",
                "login",
                "logout",
                "login_failed",
                "password_changed",
                "app_password_created",
                "app_password_deleted"
            ]
        },
        "http_redactions": {
            "description": "HTTP redaction settings.",
            "type": "object",
            "properties": {
                "enabled": {
                    "description": "Whether HTTP redactions are enabled.",
                    "type": "boolean"
                },
                "rules": {
                    "description": "The HTTP message redaction rules.",
                    "type": "array",
                    "items": {
                        "title": "HTTP redaction set.",
                        "description": "A configuration of properties to redact from HTTP messages.",
                        "type": "object",
                        "properties": {
                            "host": {
                                "description": "The URL host value to match for redaction target.",
                                "type": "string"
                            },
                            "paths": {
                                "description": "The URL path redaction set.",
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "path": {
                                            "description": "The URL path value to match for redaction target.",
                                            "type": "string"
                                        },
                                        "redactions": {
                                            "description": "The redaction set.",
                                            "type": "array",
                                            "items": {
                                                "title": "Redaction item.",
                                                "description": "The target property redaction data.",
                                                "type": "object",
                                                "properties": {
                                                    "type": {
                                                        "description": "The HTTP redaction type.",
                                                        "type": "string",
                                                        "enum": [
                                                            "*",
                                                            "query",
                                                            "header",
                                                            "request",
                                                            "response"
                                                        ]
                                                    },
                                                    "value": {
                                                        "description": "The value to match a redaction target property.",
                                                        "type": "string"
                                                    },
                                                    "remove": {
                                                        "description": "Whether the property should be entirely removed from the target.",
                                                        "type": "boolean"
                                                    }
                                                },
                                                "required": ["type", "value"]
                                            }
                                        },
                                        "glob": {
                                            "description": "Whether to glob match the URL path.",
                                            "type": "boolean"
                                        }
                                    },
                                    "required": ["path", "redactions"]
                                }
                            }
                        }
                    }
                }
            },
            "required": ["enabled"]
        },
        "http_whitelist": {
            "description": "HTTP whitelist settings.",
            "type": "object",
            "properties": {
                "enabled": {
                    "description": "Whether HTTP whitelist is enabled.",
                    "type": "boolean"
                },
                "rules": {
                    "description": "The HTTP message whitelisting rules.",
                    "type": "array",
                    "items": {
                        "title": "HTTP whitelist set.",
                        "description": "A configuration URLs to whitelist for HTTP message logging.",
                        "type": "object",
                        "properties": {
                            "host": {
                                "description": "The URL host value to match for whitelist target.",
                                "type": "string"
                            },
                            "paths": {
                                "description": "The URL path whitelist set.",
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "path": {
                                            "description": "The URL path value to match for a whitelist target.",
                                            "type": "string"
                                        },
                                        "glob": {
                                            "description": "Whether to glob match the URL path.",
                                            "type": "boolean"
                                        }
                                    },
                                    "required": ["path"]
                                }
                            },
                            "glob": {
                                "description": "Whether to glob match the URL host.",
                                "type": "boolean"
                            }
                        },
                        "required": ["host"]
                    }
                }
            },
            "required": ["enabled"]
        }
    },
    "required": [
        "version",
        "enabled",
        "wp_rest_logging",
        "wp_http_client_logging",
        "wp_user_event_logging",
        "wp_auth_logging",
        "http_redactions",
        "http_whitelist"
    ]
}
